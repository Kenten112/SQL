--TABLA--
CREATE TABLE bank_products (
    product_id INTEGER PRIMARY KEY,
    product_name TEXT,
    product_type TEXT,
    interest_rate DECIMAL(5, 2),
    monthly_fee DECIMAL(6, 2),
    minimum_balance DECIMAL(10, 2)
);

INSERT INTO bank_products (product_id, product_name, product_type, interest_rate, monthly_fee, minimum_balance)
VALUES
    (1, 'Savings Account', 'Savings', 0.75, 0.00, 100.00),
    (2, 'Checking Account', 'Checking', 0.25, 5.00, 50.00),
    (3, 'Business Account', 'Business', 1.50, 10.00, 500.00),
    (4, 'Credit Card', 'Credit Card', 18.99, 0.00, 0.00),
    (5, 'Mortgage Loan', 'Loan', 3.25, 0.00, 100000.00),
    (6, 'Certificate of Deposit', 'Savings', 1.50, 0.00, 1000.00),
    (7, 'Student Checking Account', 'Checking', 0.10, 0.00, 10.00),
    (8, 'Business Credit Card', 'Credit Card', 16.99, 0.00, 0.00),
    (9, 'Home Equity Loan', 'Loan', 4.50, 0.00, 50000.00),
    (10, 'IRA Account', 'Savings', 1.25, 0.00, 500.00),
    (11, 'Personal Loan', 'Loan', 8.75, 0.00, 5000.00),
    (12, 'Money Market Account', 'Savings', 1.00, 0.00, 500.00),
    (13, 'Youth Savings Account', 'Savings', 0.50, 0.00, 10.00),
    (14, 'Rewards Credit Card', 'Credit Card', 21.99, 0.00, 0.00),
    (15, 'Auto Loan', 'Loan', 4.25, 0.00, 20000.00);

--SQL--
--MOSTRAS LOS NOMBRES DE LOS PRODUCTOS--
select distinct product_name
from bank_products
order by product_name desc;

--MOSTRAR LOS NOMBRES DE LOS PRODUCTOS QUE EL TIPO DE PRODUCTO SEA DE SAVING O CHEKING--
select product_type, product_name
from bank_products
where product_type='Savings' or product_type='Checking';

--MOSTRAR LOS PRODUCTOS DE AHORROS CON TASA DE 0.75 O MAYOR Y SIN PAGO MENSUAL--
select product_name, product_type, interest_rate, monthly_fee
from bank_products
where product_type='Savings' and interest_rate>=0.75 and monthly_fee=0
order by interest_rate desc;



--TABLA DE EMPLEADOS--
CREATE TABLE employees (
    employee_id INTEGER PRIMARY KEY,
    department TEXT,
    salary DECIMAL(10, 2),
    years_of_experience INTEGER
);

INSERT INTO employees (employee_id, department, salary, years_of_experience)
VALUES
    (1, 'Finance', 60000.00, 5),
    (2, 'Marketing', 55000.00, 3),
    (3, 'Sales', 75000.00, 8),
    (4, 'Engineering', 80000.00, 7),
    (5, 'HR', 50000.00, 2),
    (6, 'Finance', 70000.00, 6),
    (7, 'Marketing', 60000.00, 4),
    (8, 'Sales', 85000.00, 10),
    (9, 'Engineering', 90000.00, 9),
    (10, 'HR', 55000.00, 3),
    (11, 'Sales', 72000.00, 6),
    (12, 'Sales', 80000.00, 7),
    (13, 'Engineering', 85000.00, 8),
    (14, 'Engineering', 92000.00, 10);

--MOSTRAR LOS DEPARTAMENTOS QUE HAN GASTADO 300000 O MAS--
--AL CAMBIAR EL NOMBRE DE LA COLUMNA MEJOR NO USAR ESPACIOS--    
select sum(salary) as total_spent, department
from employees
group by department 
having total_spent>=300000
order by total_spent desc;

--CUANTOS EMPLEADOS HAY EN CADA DEPARTAMENTO--
select count(employee_id), department
from employees
group by department
order by count(employee_id) desc;

--PROMEDIO DE SALARIO GASTADO POR DEPARTAMENTO MAYOR A 70000--
select avg(salary) as salary_spent_per_year, department
from employees
group by department
having salary_spent_per_year>=70000;

--TABLA DE MARATON--
CREATE TABLE marathon (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
   participant_name TEXT,
   previous_experience TEXT,
   completion_fraction REAL);

INSERT INTO marathon (participant_name, previous_experience,  completion_fraction)
    VALUES ("Sadie Hawkins", "yes", 1);
INSERT INTO marathon (participant_name, previous_experience,  completion_fraction)
    VALUES ("Brandon Flowers", "no", 0.241);
INSERT INTO marathon (participant_name, previous_experience,  completion_fraction)
    VALUES ("Michael Scott", "no", 0.804);
INSERT INTO marathon (participant_name, previous_experience,  completion_fraction)
    VALUES ("Karamo Brown", "yes", 0.9512);
INSERT INTO marathon (participant_name, previous_experience,  completion_fraction)
    VALUES ("Antoni Porowski", "yes", 0.640);
INSERT INTO marathon (participant_name, previous_experience,  completion_fraction)
    VALUES ("Rajnighanda Kapoor", "no", 1);

--CUANTOS PARTICIPANTES HAY Y CUANTO PORCENTAJE REALIZARON--
select participant_name, round (completion_fraction*100,1) as completion_percent
from marathon
order by completion_percent desc;

--CUANTO PORCENTAJE REALIZARON LOS PARTICIPANTES--
select count(participant_name) as participant,
case when completion_fraction>=0.75 then '75%+'
when completion_fraction>=0.50 then '50%+'
when completion_fraction>=0.25 then '25%+'
else 'under 25%'
end as 'quarter_completed'
from marathon
group by quarter_completed
order by participant desc;

